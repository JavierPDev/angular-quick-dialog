!function(t,e){"use strict";e.module("angularQuickDialog",["angularQuickDialog.template"]).factory("$quickDialog",function(){function t(t){this.isVisible=!1,this.name=t}function e(t){c[t].open()}function n(t){t=t||u.getTop().name,c[t].close()}function o(e){return c[e]=new t(e),c[e]}function i(){c={},u.clear()}var c={},u={stack:[],top:0,push:function(t){this.stack[this.top++]=t},pop:function(){return this.stack[--this.top]},getTop:function(){return this.stack[this.top-1]},clear:function(){this.top=0}};return t.prototype.open=function(){this.isVisible=!0,u.push(this)},t.prototype.close=function(){this.isVisible&&u.pop(),this.isVisible=!1},{open:e,close:n,create:o,reset:i}}).directive("quickDialog",["$timeout","$quickDialog",function(n,o){return{restrict:"EA",templateUrl:"template/quick-dialog.html",scope:{},transclude:!0,link:function(i,c,u){function a(){h=h||document.activeElement,f.append(d),d.bind("click",r),m.bind("keydown",l),n(function(){g.focus()})}function s(){m.unbind("keydown",l),d.unbind("click",r),d.remove(),n(function(){i.dialog.close()}),null!==h&&(h.focus(),h=k)}function l(t){t.keyCode===p&&(t.preventDefault(),s())}function r(t){t.stopPropagation(),s()}var d=e.element(document.createElement("div")).addClass("quick-dialog__backdrop"),p=27,f=e.element(document.body),m=e.element(t),g=document.getElementById(u.openFocus)||c[0],h=document.getElementById(u.closeFocus),k=document.getElementById(u.closeFocus);try{i.dialog=o.create(u.dialogName)}catch(b){throw new Error("Dialog needs a name.")}var y=!0;i.$watch("dialog.isVisible",function(t){y||(t?a():s()),y=!1}),i.$on("$routeChangeStart",function(){o.reset()})}}}])}(window,window.angular);